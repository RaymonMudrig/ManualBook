<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ManualBook - Document Browser & Semantic Query</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
    <link rel="stylesheet" href="/static/styles.css" />
    <link rel="stylesheet" href="/static/viewer.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
  </head>
  <body>
    <div class="unified-layout">
      <!-- Header with Query Bar -->
      <header class="unified-header">
        <div class="header-content">
          <h1>ðŸ“š ManualBook</h1>

          <!-- Query Form -->
          <form id="query-form" class="query-form">
            <div class="query-row">
              <input
                id="query-input"
                name="query"
                type="text"
                placeholder="Ask a question (e.g., How do I install IDX Terminal?)"
                class="query-input"
                required
              />
              <input
                id="threshold-input"
                type="number"
                step="0.01"
                min="0"
                max="1"
                value="0.72"
                class="query-param"
                title="Similarity threshold"
              />
              <input
                id="topk-input"
                type="number"
                min="1"
                max="20"
                value="5"
                class="query-param"
                title="Top K results"
              />
              <button type="submit" id="submit-btn" class="query-btn">Ask</button>
            </div>
          </form>
        </div>
      </header>

      <!-- Main Layout: TOC + Tabbed Content -->
      <div class="unified-main">
        <!-- Left Sidebar: Document Selector + TOC -->
        <aside class="left-sidebar">
          <!-- Document Selector -->
          <div class="doc-selector-container">
            <label for="doc-selector" class="doc-selector-label">Document</label>
            <select id="doc-selector" class="doc-selector">
              <option value="">Loading...</option>
            </select>
          </div>

          <!-- TOC -->
          <div class="toc-container">
            <div class="toc-header">
              <h2>Table of Contents</h2>
            </div>
            <nav id="toc-nav" class="toc-nav">
              <div class="toc-loading">Select a document</div>
            </nav>
          </div>
        </aside>

        <!-- Right Content Area: Tabs + Content -->
        <main class="content-area">
          <!-- Tab Switcher -->
          <div class="tab-switcher">
            <button id="tab-document" class="tab-btn active" data-tab="document">
              ðŸ“„ Document
            </button>
            <button id="tab-query" class="tab-btn" data-tab="query">
              ðŸ’¬ Query Result
            </button>
          </div>

          <!-- Tab Content -->
          <div class="tab-content-container">
            <!-- Document Tab -->
            <div id="content-document" class="tab-content active">
              <div id="document-status" class="content-status">
                Select a document to view
              </div>
              <article id="document-article" class="markdown-content" hidden></article>
            </div>

            <!-- Query Result Tab -->
            <div id="content-query" class="tab-content">
              <div id="query-status" class="status"></div>

              <article id="answer-block" class="answer" hidden>
                <header class="answer__header">
                  <h2>Answer</h2>
                  <span id="mode-label" class="badge"></span>
                </header>
                <div id="answer-text" class="markdown-content"></div>
              </article>

              <section id="sources-block" class="sources" hidden>
                <h3>Source Articles</h3>
                <div id="sources-list"></div>
              </section>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script src="/static/viewer.js" defer></script>
  </body>
</html>
